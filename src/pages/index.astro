---
import BaseLayout from '../layouts/BaseLayout.astro';
import BookSlideshow from '../components/BookSlideshow.astro';
import ContactForm from '../components/ContactForm.astro';
import ReviewsCarousel from '../components/ReviewsCarousel.astro';
import ReviewsModal from '../components/ReviewsModal.astro';

// Load book data from JSON files
import secondStrangerData from '../content/books/the-second-stranger.json';
import lastVisitorData from '../content/books/the-last-visitor.json';

// Load homepage content
import homepageContent from '../content/homepage.json';
import contactContent from '../content/contact.json';
---

<BaseLayout 
  title="Martin Griffin Books - Psychological Thrillers & Crime Fiction" 
  description="Award-winning psychological thriller author Martin Griffin. Discover The Second Stranger and The Last Visitor - gripping crime fiction and suspense novels that will keep you on the edge of your seat. Best new thriller books 2024-2026."
  keywords="psychological thriller, crime fiction, suspense novels, mystery books, thriller author, new thriller books 2024, best psychological thrillers 2025, crime novels, suspense fiction, Martin Griffin, Scottish thrillers, locked room mystery, The Second Stranger, The Last Visitor"
>
  <!-- Hero Section -->
  <section class="relative min-h-screen flex items-center justify-center overflow-hidden">
    <!-- Background Image with Overlay -->
    <div class="absolute inset-0 z-0">
      <img 
        src="/images/hero-background.jpg" 
        alt="Background" 
        class="w-full h-full object-cover"
      />
      <div class="absolute inset-0 bg-gradient-to-b from-primary-900/80 via-primary-800/70 to-primary-700/60"></div>
    </div>

    <!-- Content -->
    <div class="relative z-10 container mx-auto px-6 py-20 text-center text-white">
      <h1 class="text-5xl md:text-7xl lg:text-8xl font-bold mb-6 animate-fade-in">
        {homepageContent.heroTitle}
      </h1>
      {homepageContent.heroQuoteLine1 && (
        <div
          class={`text-lg md:text-xl lg:text-2xl font-light mb-2 ${
            {
              accent: "text-accent-light",
              yellow: "text-yellow-300",
              white: "text-white",
              muted: "text-gray-200",
            }[homepageContent.heroQuoteColor || "accent"]
          }`}
        >
          <span class="block">{homepageContent.heroQuoteLine1}</span>
          {homepageContent.heroQuoteLine2 && (
            <span class="block">{homepageContent.heroQuoteLine2}</span>
          )}
        </div>
      )}
      {homepageContent.heroQuoteAttribution && (
        <p class="text-sm md:text-base lg:text-lg mb-6 text-white/80">
          {homepageContent.heroQuoteAttribution}
        </p>
      )}
      <p class="text-2xl md:text-3xl lg:text-4xl font-light mb-8 text-accent-light">
        {homepageContent.heroSubtitle}
      </p>
      <p class="text-lg md:text-xl max-w-2xl mx-auto mb-12 leading-relaxed">
        {homepageContent.heroDescription}
      </p>
      <a 
        href="#books" 
        class="inline-block bg-accent hover:bg-accent-dark text-white font-semibold px-8 py-4 rounded-lg transition-all transform hover:scale-105 shadow-lg hover:shadow-xl"
      >
        {homepageContent.heroCtaLabel}
      </a>
    </div>

    <!-- Scroll Indicator -->
    <div class="absolute bottom-8 left-1/2 -translate-x-1/2 z-10 animate-bounce">
      <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3" />
      </svg>
    </div>
  </section>

  <!-- About Section -->
  <section class="py-20 bg-white">
    <div class="container mx-auto px-6">
      <div class="max-w-6xl mx-auto grid md:grid-cols-2 gap-12 items-center">
        <div class="order-2 md:order-1">
          <h2 class="text-4xl md:text-5xl font-bold mb-6 text-primary-700">
            {homepageContent.aboutHeading}
          </h2>
          <div class="prose prose-lg text-gray-700 leading-relaxed space-y-4">
            <p>{homepageContent.aboutPara1}</p>
            <p>{homepageContent.aboutPara2}</p>
            <p>{homepageContent.aboutPara3}</p>
          </div>
        </div>
        <div class="order-1 md:order-2">
          <img 
            src="/images/author.jpg" 
            alt="Martin Griffin" 
            class="rounded-lg shadow-2xl w-full max-w-md mx-auto transform hover:scale-105 transition-transform duration-300"
          />
        </div>
      </div>
    </div>
  </section>

  <!-- Books Section -->
  <section id="books" class="py-20 bg-gradient-to-b from-gray-50 to-white">
    <div class="container mx-auto px-6">
      <h2 class="text-4xl md:text-5xl font-bold text-center mb-16 text-primary-700">
        {homepageContent.booksHeading}
      </h2>

      <!-- The Second Stranger -->
      <div class="max-w-6xl mx-auto mb-24">
        <div class="grid md:grid-cols-2 gap-12 items-start">
          <div class="space-y-6">
            <h3 class="text-3xl md:text-4xl font-bold text-primary-800">
              {secondStrangerData.title}
            </h3>
            <div class="prose prose-lg text-gray-700 leading-relaxed space-y-4">
              <p class="text-xl italic text-primary-600">
                "{secondStrangerData.tagline}"
              </p>
              <p>{secondStrangerData.description1}</p>
              {secondStrangerData.description2 && <p>{secondStrangerData.description2}</p>}
              {secondStrangerData.description3 && (
                <p class="font-semibold text-primary-700">{secondStrangerData.description3}</p>
              )}
            </div>
            
            <!-- Buy Buttons -->
            <div class="flex flex-wrap gap-4">
              {secondStrangerData.amazonUK && (
                <a 
                  href={secondStrangerData.amazonUK} 
                  target="_blank"
                  rel="noopener noreferrer"
                  class="inline-flex items-center gap-2 bg-primary-600 hover:bg-primary-700 text-white font-semibold px-6 py-3 rounded-lg transition-all transform hover:scale-105 shadow-lg"
                >
                  <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M13 12h7v1.5h-7m0-4h7V11h-7m0 3.5h7V16h-7m8-12H3a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2m0 15h-9v-1h9v1m0-2h-9v-1h9v1m0-2h-9v-1h9v1m0-2h-9V9h9v3m0-4H3V6h16v2z"/>
                  </svg>
                  Buy on Amazon UK
                </a>
              )}
              {secondStrangerData.amazonUS && (
                <a 
                  href={secondStrangerData.amazonUS} 
                  target="_blank"
                  rel="noopener noreferrer"
                  class="inline-flex items-center gap-2 border-2 border-primary-600 text-primary-600 hover:bg-primary-600 hover:text-white font-semibold px-6 py-3 rounded-lg transition-all"
                >
                  Buy on Amazon US
                </a>
              )}
            </div>

            <!-- Reviews - OPTION 1: Modal (Click to Open) -->
            {secondStrangerData.reviews && secondStrangerData.reviews.length > 0 && (
              <ReviewsModal reviews={secondStrangerData.reviews} bookTitle={secondStrangerData.title} />
            )}
          </div>
          
          <!-- Book Covers Slideshow -->
          <div>
            {secondStrangerData.hasSlideshow && secondStrangerData.slideshowImages.length > 0 ? (
              <BookSlideshow slides={secondStrangerData.slideshowImages} autoplay={true} interval={7000} />
            ) : (
              <img 
                src={secondStrangerData.coverImage} 
                alt={secondStrangerData.title} 
                class="rounded-lg shadow-2xl w-full transform hover:scale-105 transition-transform duration-300"
              />
            )}
          </div>
        </div>

        <!-- Reviews - OPTION 2: Carousel (Always Visible) -->
        <!-- Uncomment this and comment out the Modal above to use this style instead -->
        <!-- {secondStrangerData.reviews && secondStrangerData.reviews.length > 0 && (
          <ReviewsCarousel reviews={secondStrangerData.reviews} bookTitle={secondStrangerData.title} />
        )} -->
      </div>

      <!-- The Last Visitor -->
      <div class="max-w-6xl mx-auto">
        <div class="grid md:grid-cols-2 gap-12 items-start">
          <!-- Book Covers Slideshow -->
          <div class="order-2 md:order-1">
            {lastVisitorData.hasSlideshow && lastVisitorData.slideshowImages.length > 0 ? (
              <BookSlideshow slides={lastVisitorData.slideshowImages} autoplay={true} interval={7000} />
            ) : (
              <img 
                src={lastVisitorData.coverImage} 
                alt={lastVisitorData.title} 
                class="rounded-lg shadow-2xl w-full transform hover:scale-105 transition-transform duration-300"
              />
            )}
          </div>
          
          <div class="order-1 md:order-2 space-y-6">
            <h3 class="text-3xl md:text-4xl font-bold text-primary-800">
              {lastVisitorData.title}
            </h3>
            <div class="prose prose-lg text-gray-700 leading-relaxed space-y-4">
              <p class="text-xl italic text-primary-600">
                "{lastVisitorData.tagline}"
              </p>
              <p>{lastVisitorData.description1}</p>
              {lastVisitorData.description2 && <p>{lastVisitorData.description2}</p>}
              {lastVisitorData.description3 && (
                <p class="font-semibold text-primary-700">{lastVisitorData.description3}</p>
              )}
            </div>
            
            <!-- Buy Buttons -->
            <div class="flex flex-wrap gap-4">
              {lastVisitorData.amazonUK && (
                <a 
                  href={lastVisitorData.amazonUK} 
                  target="_blank"
                  rel="noopener noreferrer"
                  class="inline-flex items-center gap-2 bg-primary-600 hover:bg-primary-700 text-white font-semibold px-6 py-3 rounded-lg transition-all transform hover:scale-105 shadow-lg"
                >
                  <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M13 12h7v1.5h-7m0-4h7V11h-7m0 3.5h7V16h-7m8-12H3a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2m0 15h-9v-1h9v1m0-2h-9v-1h9v1m0-2h-9v-1h9v1m0-2h-9V9h9v3m0-4H3V6h16v2z"/>
                  </svg>
                  Buy on Amazon UK
                </a>
              )}
              {lastVisitorData.amazonUS && (
                <a 
                  href={lastVisitorData.amazonUS} 
                  target="_blank"
                  rel="noopener noreferrer"
                  class="inline-flex items-center gap-2 border-2 border-primary-600 text-primary-600 hover:bg-primary-600 hover:text-white font-semibold px-6 py-3 rounded-lg transition-all"
                >
                  Buy on Amazon US
                </a>
              )}
            </div>

            <!-- Reviews - OPTION 1: Modal (Click to Open) -->
            {lastVisitorData.reviews && lastVisitorData.reviews.length > 0 && (
              <ReviewsModal reviews={lastVisitorData.reviews} bookTitle={lastVisitorData.title} />
            )}
          </div>
        </div>

        <!-- Reviews - OPTION 2: Carousel (Always Visible) -->
        <!-- Uncomment this and comment out the Modal above to use this style instead -->
        <!-- {lastVisitorData.reviews && lastVisitorData.reviews.length > 0 && (
          <ReviewsCarousel reviews={lastVisitorData.reviews} bookTitle={lastVisitorData.title} />
        )} -->
      </div>
    </div>
  </section>

  <!-- Contact Section -->
  <section id="contact" class="py-20 bg-gradient-to-b from-primary-700 to-primary-900 text-white">
    <div class="container mx-auto px-6">
      <div class="max-w-2xl mx-auto">
        <h2 class="text-4xl md:text-5xl font-bold text-center mb-8">
          {contactContent.heading}
        </h2>
        <p class="text-xl text-center mb-12 text-accent-light">
          {contactContent.description}
        </p>
        
        <ContactForm />
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="bg-primary-900 text-white py-12">
    <div class="container mx-auto px-6 text-center">
      <p class="text-lg mb-4">
        {homepageContent.footerLine1.replace("{{year}}", String(new Date().getFullYear()))}
      </p>
      <p class="text-sm text-accent-light">{homepageContent.footerLine2}</p>
    </div>
  </footer>
</BaseLayout>

<style>
  @keyframes fade-in {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .animate-fade-in {
    animation: fade-in 1s ease-out;
  }

  .prose p {
    margin-bottom: 1rem;
  }
</style>
