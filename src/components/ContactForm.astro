---
// Contact Form Component
---

<form 
  id="contact-form"
  class="space-y-6 bg-white/10 backdrop-blur-lg p-8 rounded-xl shadow-2xl"
>
  <div id="form-message" class="hidden p-4 rounded-lg"></div>
  
  <div>
    <label for="name" class="block text-sm font-medium mb-2">Name</label>
    <input 
      type="text" 
      id="name" 
      name="name" 
      required
      class="w-full px-4 py-3 rounded-lg bg-white/20 border border-white/30 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-accent-light focus:border-transparent"
      placeholder="Your name"
    />
  </div>
  
  <div>
    <label for="email" class="block text-sm font-medium mb-2">Email</label>
    <input 
      type="email" 
      id="email" 
      name="email" 
      required
      class="w-full px-4 py-3 rounded-lg bg-white/20 border border-white/30 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-accent-light focus:border-transparent"
      placeholder="your.email@example.com"
    />
  </div>
  
  <div>
    <label for="message" class="block text-sm font-medium mb-2">Message</label>
    <textarea 
      id="message" 
      name="message" 
      rows="5" 
      required
      class="w-full px-4 py-3 rounded-lg bg-white/20 border border-white/30 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-accent-light focus:border-transparent resize-none"
      placeholder="Your message..."
    ></textarea>
  </div>
  
  <button 
    type="submit"
    id="submit-btn"
    class="w-full bg-accent hover:bg-accent-dark text-white font-semibold px-8 py-4 rounded-lg transition-all transform hover:scale-105 shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed"
  >
    <span id="submit-text">Send Message</span>
    <span id="submit-loading" class="hidden">Sending...</span>
  </button>
</form>

<script>
  const form = document.getElementById('contact-form') as HTMLFormElement;
  const submitBtn = document.getElementById('submit-btn') as HTMLButtonElement;
  const submitText = document.getElementById('submit-text') as HTMLSpanElement;
  const submitLoading = document.getElementById('submit-loading') as HTMLSpanElement;
  const formMessage = document.getElementById('form-message') as HTMLDivElement;

  form.addEventListener('submit', async (e) => {
    e.preventDefault();

    // Disable form
    submitBtn.disabled = true;
    submitText.classList.add('hidden');
    submitLoading.classList.remove('hidden');
    formMessage.classList.add('hidden');

    // Get form data
    const formData = new FormData(form);
    const data = {
      name: formData.get('name'),
      email: formData.get('email'),
      message: formData.get('message')
    };

    try {
      // Send to serverless function
      const response = await fetch('/api/contact', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(data)
      });

      const result = await response.json();

      if (response.ok) {
        // Success
        formMessage.textContent = 'Thank you! Your message has been sent successfully.';
        formMessage.className = 'p-4 rounded-lg bg-green-500/20 border border-green-500 text-white';
        formMessage.classList.remove('hidden');
        form.reset();
      } else {
        // Error
        formMessage.textContent = result.error || 'Something went wrong. Please try again.';
        formMessage.className = 'p-4 rounded-lg bg-red-500/20 border border-red-500 text-white';
        formMessage.classList.remove('hidden');
      }
    } catch (error) {
      formMessage.textContent = 'Network error. Please check your connection and try again.';
      formMessage.className = 'p-4 rounded-lg bg-red-500/20 border border-red-500 text-white';
      formMessage.classList.remove('hidden');
    } finally {
      // Re-enable form
      submitBtn.disabled = false;
      submitText.classList.remove('hidden');
      submitLoading.classList.add('hidden');
    }
  });
</script>
